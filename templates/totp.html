<% include header %>

<div class="container api-page">
  <main role="main" id="main-content" class="cd-container">
    <div class="cd-layout-content">
      <div class="container mx-auto max-w-sm mx-auto [ flow ]">
          <h1 class="page-header__heading">Two-factor authentication</h1>

          <% if (alert) { %>
            <div class="alert alert--inline alert--<%= alert.type %>" role="alert">
              <div class="alert__inner">
                <%= alert.message %>
              </div>
            </div>
          <% } %>

          <form method="post" action="<%= destination %>" class="[ flow ]">
            <div class="form-field">
              <label for="x-hid-totp" translate>Authentication code</label>
              <input type="text" name="x-hid-totp" id="x-hid-totp" autocomplete="off" placeholder="Authentication code" required>
            </div>
            <div class="form-field">
              <input type="checkbox" name="x-hid-totp-trust" id="x-hid-totp-trust" value="1"> Save this device for 30 days
            </div>
            <input type="hidden" name="redirect" value="<%= query.redirect %>" />
            <input type="hidden" name="client_id" value="<%= query.client_id %>" />
            <input type="hidden" name="redirect_uri" value="<%= query.redirect_uri %>" />
            <input type="hidden" name="response_type" value="<%= query.response_type %>" />
            <input type="hidden" name="state" value="<%= query.state %>" />
            <input type="hidden" name="scope" value="<%= query.scope %>" />
            <input type="hidden" name="nonce" value="<%= query.nonce %>" />
            <input type="hidden" name="crumb" value="<%= crumb %>" />

            <button type="submit" class="cd-button cd-button--bold">
              Verify
            </button>
          </form>
        </div>
      </div>
    </div>
  </main>
</div>
<% include footer %>
